{% extends "GUI/templates/header.html" %}

{% block body %}

<div class="container">
  <div class="row">
    <div class="[ col-xs-offset-0 col-xs-12 col-sm-offset-1 col-sm-10 ]">
      <div class="btn-group btn-group-justified">
        <a href="/GUI/adds" class="btn btn-success btn-lg active" role="button"> Installed</a>
        <a href="/GUI/newAdd" class="btn btn-success btn-lg" role="button"><i class="fa fa-plus"></i> Add </a>
      </div>
  	</br>
      <ul id="addUl" class="event-list">

        <!-- HTML - CODE EXAMPLE WHICH IST GENERATED BY JS  -->

        <!-- <li>
          <img alt="Symbol Numbergames" src="/static/images/Numbergame_symbol.png" />
          <div class="info">
            <h2 class="title">Numbergames - TestApp 1 </h2>
            <p class="desc">Ein kleines Zahlen-Retespiel. Nach eingabe einer Zahl
                            in eine Maske wird die Zahl mit einer Hinterlegten
                            Zahl verglichen und ausgegeben. </p>

            <ul>
              <li style="width:33%;"><a href="#website"><span class="fa fa-globe"></span> Website</a></li>
              <li style="width:34%;"><a href="#Kontakt"><span class="fa fa-envelope"></span> Kontakt</a></li>
              <li style="width:33%;"><a href="#Install"><span class="fa fa-download"></span> Installieren</a></li>
            </ul>

          </div>

          <div class="social">
            <ul>
              <li class="facebook" style="width:33%;"><a href="#facebook"><span class="fa fa-facebook"></span></a></li>
              <li class="twitter" style="width:34%;"><a href="#twitter"><span class="fa fa-twitter"></span></a></li>
              <li class="google-plus" style="width:33%;"><a href="#google-plus"><span class="fa fa-google-plus"></span></a></li>
            </ul>
          </div>

        </li> -->

      </ul>
    </div>
  </div>
</div>


<script>
/*
This JavaScript generates the list-entries from the delivered dictionary.
The safe-filter is important, because without it JS escapes some chars.
*/
var add_list = {{ variables | safe }};
console.log(add_list);

// DEBUGGING
// alert(JSON.stringify(asset_list));

/*
ITERATION THROW ALL ENTRIES OF THE DICT.
*/
for (var add in add_list) {
    // Check, if entries exist
    if (!add_list.hasOwnProperty(add))
    continue;

    var obj = add_list[add];

    // find the Ul which schould contain the list-entries
    var addUl = document.getElementById("addUl")
    // generata an "li"
    var addLi = document.createElement("li");
    // append the li-tag to the ul-tag
    addUl.appendChild(addLi);

    // generate and append an img
    // var addImg = document.createElement("img");
    // addImg.setAttribute("src", obj.thumbnail);
    // addLi.appendChild(addImg);

    // generate and append an div
    var addDiv1 = document.createElement("div");
    addDiv1.setAttribute("class", "info");
    addLi.appendChild(addDiv1);

    var addTitle = document.createElement("h2");
    addTitle.setAttribute("class", "title");
    addDiv1.appendChild(addTitle);

    var addTitleText = document.createTextNode(obj.title);
    addTitle.appendChild(addTitleText);

    var addDesc = document.createElement("p");
    addDesc.setAttribute("class", "desc");
    addDiv1.appendChild(addDesc);

    var addDescText = document.createTextNode(obj.info);
    addDesc.appendChild(addDescText);

    // BUTTON WEBSITE //

    // The WEBSITE-Button should only be generated if there is really a WEBSITE
    // If there is no Website, the obj.template - variable would be
    // "No_Template_available"

    var ulBtn = document.createElement("ul");
    addDiv1.appendChild(ulBtn);

    var template = "No_Template_available";
    if(obj.template == template)
    {

    var addBtnLiWeb = document.createElement("li");
    addBtnLiWeb.setAttribute("style", "width:60%");
    ulBtn.appendChild(addBtnLiWeb);

     var addBtnWebText2 = document.createTextNode(" No Template");
     addBtnLiWeb.appendChild(addBtnWebText2);

    }
    else{

    var addBtnLiWeb = document.createElement("li");
    addBtnLiWeb.setAttribute("style", "width:60%");
    addBtnLiWeb.setAttribute("style", "background-color:green");
    ulBtn.appendChild(addBtnLiWeb);

    var addBtnWebA = document.createElement("a");
    addBtnWebA.setAttribute("href", obj.template);
    addBtnLiWeb.appendChild(addBtnWebA);

    var addBtnWebSpan = document.createElement("span");
    addBtnWebSpan.setAttribute("class", "fa fa-globe fa-lg");
    addBtnWebA.appendChild(addBtnWebSpan);

    var addBtnWebText = document.createTextNode(" Go To Template");
    addBtnWebA.appendChild(addBtnWebText);
    }


    // BUTTON REMOVE //

    var addBtnLiInst = document.createElement("li");
    addBtnLiInst.setAttribute("style", "width:40%");
    addBtnLiInst.setAttribute("style", "background-color:#DB5461");
    ulBtn.appendChild(addBtnLiInst);

    var addBtnInstA = document.createElement("a");
    addBtnInstA.setAttribute("onclick", "remove('" + obj.identity + "')");
    addBtnLiInst.appendChild(addBtnInstA);

    var addBtnInstSpan = document.createElement("span");
    addBtnInstSpan.setAttribute("class", "fa fa-times-circle fa-2x");
    addBtnInstA.appendChild(addBtnInstSpan);

    var addBtnInstText = document.createTextNode(" Remove");
    // addBtnInstText.setAttribute("id", "install"+obj.title)
    // addBtnInstText.setAttribute("onclick", "changeToInstalled(obj.title)")
    addBtnInstA.appendChild(addBtnInstText);

    function remove(add_identity){
        $.ajax({
            url: '/module_installer/remove',
            data: JSON.stringify({"module_id" : add_identity}),
            contentType: "application/json; charset=utf-8",
            dataType: "json",
            type: 'DELETE',
            success: function(result) {
                alert(result);
            }
        });

    }

}

</script>

<!-- A FUNCTION TO CHANGE THE INSTALLATION BUTTON ON CLICK -->

<!-- <script>

function changeToInstalled(add_title){
  document.getElementById("install"+add_title).innerHTML = "Installiert"
}

</script> -->


{% endblock %}
